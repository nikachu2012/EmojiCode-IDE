<!DOCTYPE html>
<html>

<head>
  <title>EmojiScript</title>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="modules/normalize.css"/>
  <link rel="stylesheet" href="src/style.css" />
  <link rel="stylesheet" href="src/bottom.css" />
  <link rel="stylesheet" href="src/body.css" />
  <link rel="stylesheet" href="src/head.css" />
  <link rel="stylesheet" href="src/canvas.css" />
  <link rel="stylesheet" href="src/console.css" />
  <link rel="stylesheet" href="src/modal.css">
  <link rel="stylesheet" href="src/viewButton.css">
  <link rel="stylesheet" href="src/menu.css">
  <link rel="stylesheet" href="src/debug.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />


  <link rel="stylesheet" href="src/workspace-color.css">
</head>

<body>
  <div class="head">
    <img src="./assets/logo.svg" alt="EmojiCode">
    <span class="text">EmojiScript</span>
    <button id="file">ファイル</button>
    <button id="help">ヘルプ</button>
    <button id="headButton_run" class="material-symbols-outlined" style="font-size: 18px;color: #4cbf56;" onclick="pushFlag()">flag</button>
    <button id="headButton_circle" class="material-symbols-outlined hbstop"
      style="font-size: 18px; color: #ec5959;">circle</button>

  </div>

  <div class="body">
    <div class="code" id="code" style="width: calc(100vw - 500px)"></div>
    <div class="run" id="run">
      <div class="button-body">
        <div class="left">
          <button class="material-symbols-outlined flag" id="flag" title="実行" onclick="pushFlag();">flag</button>
          <button class="material-symbols-outlined circle" title="停止">circle</button>
        </div>
        <div class="right">
          <button class="material-symbols-outlined fullscreen" id="close" title="右側を閉じる">close</button>
        </div>
      </div>
      <div class="run-canvas" id="run-canvas"></div>

      <div id="right-bottom-tab">
        <ul class="tab">
          <li class="list"><img src="https://img.icons8.com/fluency/48/000000/circled-play.png" class="icon" />コード実行
          </li>
          <li class="list"><img src="https://img.icons8.com/stickers/100/000000/cat.png" class="icon" />スプライト</li>
          <li class="list"><img src="https://img.icons8.com/color/48/000000/low-volume--v1.png" class="icon" />音</li>
        </ul>
        <div class="tab-body">

          <div id="runcode-tab" class="flex">
            <ul class="selector">
              <li><img src="https://img.icons8.com/fluency/48/000000/console.png" class="icon" />コンソール</li>
              <li><img src="https://img.icons8.com/fluency/48/000000/box-important.png" class="icon" />エラー</li>
              <li><img src="https://img.icons8.com/color/48/000000/javascript--v1.png" class="icon" />出力JS</li>
              <li><img src="https://img.icons8.com/fluency/48/000000/deciduous-tree.png" class="icon" />出力AST</li>
              <!-- <li><img src="https://img.icons8.com/fluency/48/000000/details-pane.png" class="icon" />詳細</li> -->
            </ul>
            <div class="runcode-body" id="console">
              <div class="no-run">
                まだ一度も実行されていません。<br>
                実行するとここに情報が表示されます。<br>
                上部の旗ボタンを押すと実行できます。
              </div>
              <!--<div class="logArea" id="logArea">
                
              </div>-->
            </div>
            <div class="runcode-body" id="error">
              <div class="no-run">
                まだ一度も実行されていません。<br>
                実行するとここに情報が表示されます。<br>
                上部の旗ボタンを押すと実行できます。
              </div>
              <!-- //OK
                <div class="success material-symbols-outlined" style="font-size: 40pt;">done</div>
                <span class="text">エラーは発見されませんでした</span>
              -->

              <!-- //error detected
                <div class="error material-symbols-outlined" style="font-size: 40pt;">close</div>
                <span class="text">エラーが発見されました。</span>
                <div class="message">
                  メッセージ
                </div>
              -->
            </div>
            <div class="runcode-body" id="outputJS">
              <div class="no-run">
                まだ一度も実行されていません。<br>
                実行するとここに情報が表示されます。<br>
                上部の旗ボタンを押すと実行できます。
              </div>
            </div>
            <div class="runcode-body" id="outputAST">
              <div class="no-run">
                まだ一度も実行されていません。<br>
                実行するとここに情報が表示されます。<br>
                上部の旗ボタンを押すと実行できます。
              </div>
            </div>
            <!-- <div class="runcode-body" id="detail">
              <div class="no-run">
                まだ一度も実行されていません。<br>
                実行するとここに情報が表示されます。<br>
                上部の旗ボタンを押すと実行できます。
              </div>
            </div>
          -->
          </div>
        </div>
        <div class="tab-body">
          <button class="create" onclick="displayModal('modal1')"><img
              src="https://img.icons8.com/color/48/000000/plus-math.png"
              style="display: inline-block; vertical-align: top; width: 18px;" />スプライトの作成</button>
          <div class="sprite-body" id="spriteList">
            <div class="no-run">スプライトが作成されていません。</div>
          </div>


        </div>
        <div class="tab-body">
          <button class="create" onclick="displayModal('modal3')"><img
              src="https://img.icons8.com/color/48/000000/plus-math.png"
              style="display: inline-block; vertical-align: top; width: 18px;" />音声の追加</button>
          <div class="sprite-body" id="soundList">
            <div class="no-run">画像がありません</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="bottom">
    <div class="left_to">
      <span class="text">EmojiCode&nbsp;<span id="ec_version"></span></span>
      <div class="button">Contact</div>
    </div>

    <div class="right_to">
      <span class="text">
        Created&nbsp;by&nbsp;<a href="https://github.com/nikachu2012">nikachu2012</a>
      </span>

    </div>
  </div>

  <div class="menu menu_file" onclick="buttonFile();">
    <div class="menu-pulldown menu-pulldown-file">
      <div class="content" onclick="window.open(location.href, '_blank');">新しいタブで開く</div>
      <hr>
      <div class="content" id="quickLoad">クイックロード</div>
      <div class="content" onclick="displayModal('modal6')">ファイルから開く</div>
      <hr>
      <div class="content" id="quickSave">クイックセーブ</div>
      <div class="content" id="fileSaveButton">ファイル保存</div>

    </div>
  </div>

  <div class="menu menu_help" onclick="buttonHelp();">
    <div class="menu-pulldown menu-pulldown-help">
      <div class="content" onclick="window.open('https:\/\/emojicode-doc.nikachu.net', '_blank');">ドキュメント</div>
      <div class="content">お問い合わせ</div>
      <hr>
      <div class="content" onclick="displayModal('modal4')">バージョン情報</div>
    </div>
  </div>

  <div class="modal modal1">
    <!-- スプライト作成モーダル -->
    <div class="modal-window 1">
      <div class="modal-windowTitle">
        <div class="title">スプライト作成</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        <div class="upload" id="uploadArea">
          <input type="file" id="fileUpload" accept="image/jpeg,image/png" onchange="fileUpdate();">
        </div>
        <input type="text" id="inputId" placeholder="IDを入力" class="inputID">

        <div class="container">
          <dl class="accordion">
            <dt>画像設定</dt>
            <dd id="pictureSetting" class="pictureSetting">
              画像を選択すると表示されます。
            </dd>
          </dl>
        </div>
        <button class="confirm" onclick="filebase64();">確定</button>

      </div>
    </div>
  </div>

  <div class="modal modal2">
    <div class="modal-window 2">
      <div class="modal-windowTitle">
        <div class="title">スプライトサイズ変更</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        <button id="sizeChange_button">キャンパスサイズに合わせる</button>
        <input id="sizeChange_width" type="number" placeholder="横幅" class="sizeChange_input">&nbsp;px
        <input id="sizeChange_height" type="number" placeholder="縦幅" class="sizeChange_input">&nbsp;px
        <button class="confirm" id="sizeChange_confirm">確定</button>

      </div>
    </div>
  </div>

  <div class="modal modal3">
    <div class="modal-window 3">
      <div class="modal-windowTitle">
        <div class="title">音声の追加</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        <input id="addSound_input" type="url" placeholder="音声がアップロードされたURL" class="addSound_input">
        <input id="addSound_inputID" type="url" placeholder="IDを入力" class="addSound_input">
        <button class="confirm" id="addSound_confirm">確定</button>
      </div>
    </div>
  </div>

  <div class="modal modal4">
    <div class="modal-window 4">
      <div class="modal-windowTitle">
        <div class="title">バージョン情報</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        <span style="font-size:xx-large;">EmojiCode</span><br>
        Created by <a href="https://github.com/nikachu2012" target="_blank">nikachu2012</a><br>

        <table>
          <tbody>
            <tr>
              <td>バージョン</td>
              <td id="ec_version"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="modal modal5">
    <div class="modal-window 5">
      <div class="modal-windowTitle">
        <div class="title">クイックロード</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        読み込むファイルを選択してください<br>
        <hr>
        <div id="listBody"></div>
      </div>
    </div>
  </div>

  <div class="modal modal6">
    <!-- スプライト作成モーダル -->
    <div class="modal-window 6">
      <div class="modal-windowTitle">
        <div class="title">ファイル読み込み</div>
        <button class="closeButton material-symbols-outlined" onclick="closeModal();">close</button>
      </div>
      <div class="modal-contents">
        <div class="upload" id="saveFileArea">
          <input type="file" id="saveFileLoad" onchange="saveLoadUpdate();">
        </div>
        <button class="confirm" id="saveFileConfirm">確定</button>
      </div>
    </div>
  </div>

  <div class="viewButton" id="viewButton" style="visibility: hidden;">
    <span class="material-symbols-outlined icon">chevron_right</span>
  </div>

  <div class="debug_body">
    <div class="titlebar">debugmenu</div>
    <div class="hr"></div>
    <button id="allDeleteIDB">IndexedDBの全削除</button>
  </div>

  <script src="console/index.js"></script>

  <script src="https://unpkg.com/blockly/blockly.min.js"></script>
  <script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
  <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
  <script src="https://unpkg.com/blockly/msg/ja.js"></script>
  <script src="darkmode/index.js"></script>

  <script src="modules/localforage.min.js"></script>

  <script src="modules/acorn.js"></script>
  <script src="modules/jquery.js"></script>
  <link rel="stylesheet" href="modules/toastr.min.css">
  <script src="modules/toastr.min.js"></script>

  <script src="jquery.tab/index.js"></script>

  <script src="./emojicode/emojicode_def.js"></script>
  <script src="./emojicode/emojicode_stub.js"></script>

  <script src="emojicode/defaultFunctions/index.js"></script>
  <script src="control/index.js"></script>
  <script src="tab/index.js"></script>

  <script src="workspace.js" defer></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/vs2015.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.40/Tone.js"></script>
  
  <script src="./EmojiCode-sprite/emojisprite.js"></script>
  <script src="./EmojiCode-audio/emojiaudio.js"></script>
  <script src="./control/sprite.js"></script>
  <script src="./control/sound.js"></script>
  <script src="./control/modal.js"></script>
  <script src="./control/save.js"></script>
  <script src="./control/debugmenu.js"></script>

  <script>
    /*window.onload = function () {
      // ブラウザ上に表示する文字列を保持する一時変数
      let outstr = "";
      // console.logの挙動
      console.log = (...args) => {
        for (let arg of args) {
          // console.logに入力された文字列を改行つきで保持
          outstr = arg + "<br>";
        }
        // HTMLのid="console"に対して文字列outstrを設定する
        //document.getElementById("console").innerHTML = outstr;

        log(outstr)
      }
    }*/

    (function () {
      if (window.matchMedia && window.matchMedia('(max-device-width: 1000px)').matches) {
        document.getElementById('run').style.visibility = 'hidden';
        document.getElementById('run').style.width = '0px'

        document.getElementById('code').style.width = '100vw'
        document.getElementById('viewButton').style.visibility = 'visible'
      } else {
        return false;
      }
    })();
    document.querySelectorAll('#ec_version').forEach((e) => {
      e.innerHTML = 'v1.0beta'
    })
  </script>
</body>

</html>
